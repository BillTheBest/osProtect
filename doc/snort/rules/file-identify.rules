# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY language.engtesselate.ln file download request"; flow:to_client,established; content:"language.engtesselate.ln"; fast_pattern; http_uri; flowbits:set,file.engtesselate; flowbits:noalert; classtype:misc-activity; sid:19252; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Compound File Binary v3 file magic detection"; flow:to_client,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:">|00 03 00|"; within:4; distance:16; flowbits:set,file.oless.v3; flowbits:noalert; classtype:misc-activity; sid:16474; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Embedded Open Type Font file download request"; flow:to_server,established; content:".eot"; fast_pattern; nocase; http_uri; pcre:"/\x2eeot([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.eot; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Embedded_OpenType; classtype:misc-activity; sid:15518; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY TwinVQ file download request"; flow:to_server,established; content:".vqf"; fast_pattern; nocase; http_uri; pcre:"/\x2evqf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.vqf; flowbits:noalert; classtype:misc-activity; sid:15385; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"pdin"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20504; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MachO x64 Big Endian file magic detection"; flow:to_client,established; file_data; content:"|FE ED FA CF|"; within:4; fast_pattern; flowbits:set,file.macho64be; flowbits:noalert; classtype:misc-activity; sid:20491; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Portable Executable binary file download request"; flow:to_server,established; content:".exe"; fast_pattern; nocase; http_uri; pcre:"/\x2eexe([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.exe; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.exe; classtype:misc-activity; sid:16425; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ffmpeg file magic detection"; flow:to_client,established; file_data; content:"|34 58 4D 56|"; within:4; fast_pattern; flowbits:set,file.ffmpeg; flowbits:noalert; classtype:misc-activity; sid:20513; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Postscript file magic detection"; flow:to_client,established; file_data; content:"|25 21 50 53 2D 41 64 6F 62 65 2D|"; within:11; fast_pattern; flowbits:set,file.postscript; flowbits:noalert; classtype:misc-activity; sid:20454; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY CryptFF file magic detection"; flow:to_client,established; file_data; content:"|B6 B9 AC AE FE FF FF FF|"; fast_pattern; flowbits:set,file.cryptff; flowbits:noalert; classtype:misc-activity; sid:20479; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY TNEF file magic detection"; flow:to_client,established; file_data; content:"x|9F|>|22|"; within:4; fast_pattern; flowbits:set,file.tnef; flowbits:noalert; classtype:misc-activity; sid:20476; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY OLE Document file magic detection"; flow:to_client,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; fast_pattern; flowbits:set,file.ole; flowbits:noalert; classtype:misc-activity; sid:17314; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".jpg"; fast_pattern; nocase; http_uri; pcre:"/\x2ejpg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16406; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Help Workshop CNT Help file download request"; flow:to_server,established; content:".cnt"; fast_pattern; nocase; http_uri; pcre:"/\x2ecnt([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cnt; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.cnt; classtype:misc-activity; sid:17364; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|06 08|"; within:4; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20467; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Media ASX file download request"; flow:to_server,established; content:".asx"; fast_pattern; nocase; http_uri; pcre:"/\x2easx([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.asx; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Advanced_Stream_Redirector; classtype:misc-activity; sid:17116; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY WordPerfect file magic detection"; flow:to_client,established; file_data; content:"|FF|WPC"; within:4; fast_pattern; content:"|01 0A 02 01|"; within:4; distance:4; reference:url,www.corelconnected.com/html/files/WPFF_%21DocumentStructure.htm; classtype:misc-activity; sid:15575; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks Realplayer .ram playlist file download request"; flow:to_server,established; content:".ra"; fast_pattern; nocase; http_uri; pcre:"/\x2eram?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2419; rev:17;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY SVG file download request"; flow:to_server,established; content:".svg"; fast_pattern; nocase; http_uri; pcre:"/\x2esvgz?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.svg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.svg; classtype:misc-activity; sid:15427; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Visual Basic script file download request"; flow:to_server,established; content:".vbs"; fast_pattern; nocase; http_uri; pcre:"/\x2evbs([\?\x5c\x2f]|$)/smiU"; reference:url,en.wikipedia.org/wiki/Vbs; classtype:misc-activity; sid:18758; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY JPEG file magic detection"; flow:to_client,established; file_data; content:"JFIF|00|"; offset:5; fast_pattern; flowbits:set,file.jpeg; flowbits:noalert; classtype:misc-activity; sid:20483; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office PowerPoint .MSProducerZ file download request"; flow:to_server,established; content:".MSProducerZ"; fast_pattern; nocase; http_uri; pcre:"/\x2eMSProducerZ([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.msproducer; flowbits:noalert; classtype:misc-activity; sid:16477; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JAR file download request"; flow:to_server,established; content:".jar"; fast_pattern:only; nocase; http_uri; pcre:"/\x2ejar([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jar; flowbits:noalert; classtype:misc-activity; sid:20621; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft SYmbolic LinK file magic detection"; flow:to_client,established; file_data; content:"ID|3B|P"; within:4; fast_pattern; nocase; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2008-0112; reference:url,en.wikipedia.org/wiki/SYmbolic_LinK_(SYLK); reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-014; classtype:misc-activity; sid:13585; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Core Audio Format file download request"; flow:to_server,established; content:".caf"; fast_pattern; nocase; http_uri; pcre:"/\x2ecaf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.caff; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Core_Audio_Format; classtype:misc-activity; sid:15444; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows .NET Manifest file download request"; flow:to_server,established; content:".manifest"; fast_pattern; nocase; http_uri; pcre:"/\x2emanifest([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.manifest; flowbits:noalert; reference:bugtraq,21688; reference:cve,2006-6696; reference:url,en.wikipedia.org/wiki/ASP.NET; classtype:misc-activity; sid:17509; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ARJ file magic detection"; flow:to_client,established; file_data; content:"|60 EA 00 00|"; within:4; fast_pattern; flowbits:set,file.arj; flowbits:noalert; classtype:misc-activity; sid:20475; rev:3;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"FILE-IDENTIFY Tiff big endian file magic detection"; flow:to_client,established; file_data; content:"MM|00 2A|"; within:4; fast_pattern; flowbits:set,file.tiff.big; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:17230; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY EPS file download request"; flow:to_server,established; content:".eps"; fast_pattern; nocase; http_uri; pcre:"/\x2eeps([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.eps; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Encapsulated_PostScript; classtype:misc-activity; sid:13983; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft multimedia format file download request"; flow:to_server,established; content:".wma"; fast_pattern; nocase; http_uri; pcre:"/\x2ewma([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.wma; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Windows_Media_Audio; classtype:misc-activity; sid:15921; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Outlook EML file download request"; flow:to_server,established; content:".eml"; http_uri; pcre:"/\x2eeml([\?\x5c\x2f]|$)/smiU"; metadata:policy security-ips drop; reference:nessus,10767; classtype:misc-activity; sid:1233; rev:16;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY 7zip file magic detection"; flow:to_client,established; file_data; content:"7z|BC AF 27 1C|"; within:6; fast_pattern; flowbits:set,file.7zip; flowbits:noalert; classtype:misc-activity; sid:20487; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Ultimate Packer for Executables/UPX v2.90,v2.93-3.00 packed file magic detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"`|BE|"; content:"|8D BE|"; within:2; distance:4; pcre:"/^\x57(\x83\xCD\xFF)?\x89\xE5\x8D\x9C\x24.{4}\x31\xC0\x50\x39\xDC\x75\xFB\x46\x46\x53\x68.{4}\x57\x83\xC3\x04\x53\x68.{4}\x56\x83\xC3\x04\x53\x50\xC7\x03.{4}\x90\x90/R"; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16436; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY GIF file download request"; flow:to_server,established; content:".gif"; fast_pattern; nocase; http_uri; pcre:"/\x2egif([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.gif; flowbits:noalert; classtype:misc-activity; sid:17394; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Google Chrome extension file download request"; flow:to_server,established; content:".crx"; fast_pattern; nocase; http_uri; pcre:"/\x2ecrx([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.crx; reference:url,en.wikipedia.org/wiki/Google_Chrome; classtype:misc-activity; sid:19215; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MPEG video stream file magic detection"; flow:to_client,established; file_data; content:"|00 00 01 B3|"; within:4; fast_pattern; flowbits:set,file.mpeg; flowbits:noalert; classtype:misc-activity; sid:20450; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Excel file download request"; flow:to_server,established; content:".xls"; fast_pattern; nocase; http_uri; pcre:"/\x2exls([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xls; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.xls#File_formats; classtype:misc-activity; sid:15463; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RAR file magic detection"; flow:to_client,established; file_data; content:"Rar"; within:3; fast_pattern; flowbits:set,file.rar; flowbits:noalert; classtype:misc-activity; sid:20472; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Access file magic detection"; flow:to_client,established; file_data; content:"Standard Jet DB"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26468; reference:cve,2005-0944; reference:cve,2007-6026; reference:cve,2008-1092; reference:url,en.wikipedia.org/wiki/Microsoft_access; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-028; reference:url,www.microsoft.com/technet/security/advisory/950627.mspx; classtype:misc-activity; sid:13626; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY FlashPix file download request"; flow:to_server, established; content:".fpx"; fast_pattern; nocase; http_uri; pcre:"/\x2efpx([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.fpx; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Fpx; classtype:misc-activity; sid:17739; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MP3 file magic detection"; flow:to_client,established; file_data; content:"ID3"; within:3; fast_pattern; flowbits:set,file.mp3; flowbits:noalert; classtype:misc-activity; sid:20460; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY PDF file download request"; flow:to_server,established; content:".pdf"; fast_pattern; nocase; http_uri; pcre:"/\x2epdf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.pdf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Pdf; classtype:misc-activity; sid:15013; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft emf file download request"; flow:to_server,established; content:".emf"; fast_pattern; http_uri; pcre:"/\x2eemf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.emf; metadata:policy security-ips drop; reference:bugtraq,10120; reference:bugtraq,28819; reference:bugtraq,9707; reference:cve,2003-0906; reference:cve,2007-5746; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-032; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-001; classtype:misc-activity; sid:2435; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detection"; flow:to_client,established; file_data; content:"|46 4C 56 01|"; within:4; fast_pattern; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20497; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY VideoLAN VLC file magic detection"; flow:to_client,established; file_data; content:"SCRM"; depth:4; offset:44; flowbits:set,file.s3m; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.s3m; classtype:misc-activity; sid:20522; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Pagemaker file download request"; flow:to_server,established; content:".pmd"; fast_pattern; nocase; http_uri; pcre:"/\x2epmd([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.pmd; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.pmd; classtype:misc-activity; sid:17552; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"free"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20503; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"mdat"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20502; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY TIFF file download request"; flow:to_server,established; content:".tif"; fast_pattern; nocase; http_uri; pcre:"/\x2etif(f)?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.tiff; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.tiff; classtype:misc-activity; sid:17732; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Excel file magic detection"; flow:to_client,established; file_data; content:"|D0 CF 11 E0|"; within:4; content:"W|00|o|00|r|00|k|00|b|00|o|00|o|00|k|00|"; distance:0; fast_pattern; flowbits:set,file.xls; flowbits:noalert; classtype:misc-activity; sid:19166; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Visual Studio DISCO file download request"; flow:to_server,established; content:".disco"; fast_pattern; nocase; http_uri; pcre:"/\x2edisco([\?\x5c\x2f]|$)/smiU"; reference:url,msdn.microsoft.com/en-us/library/8k0zafxb(v=vs.80).aspx; classtype:misc-activity; sid:19233; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Ultimate Packer for Executables/UPX v0.62-v1.22 packed file magic detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|8A 06|F|88 07|G|01 DB|u|07 8B 1E 83 EE FC 11 DB|"; pcre:"/^(\x72\xED\xB8\x01.{3}|\x8A\x07\x72\xEB\xB8\x01\x00\x00\x00)\x01\xDB\x75\x07\x8B\x1E\x83\xEE\xFC\x11\xDB\x11\xC0\x01\xDB[\x73\x77].{3}\x8B\x1E\x83\xEE\xFC/R"; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16435; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY DXF file download request"; flow:to_server,established; content:".dxf"; fast_pattern; nocase; http_uri; pcre:"/\x2edxf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dxf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Dxf; classtype:misc-activity; sid:15987; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY LZH file download request"; flow:to_server,established; content:".lzh"; fast_pattern; nocase; http_uri; pcre:"/\x2elzh([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.lzh; flowbits:noalert; classtype:misc-activity; sid:17540; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows HTML help workshop file download request"; flow:to_server,established; content:".hhp"; fast_pattern; nocase; http_uri; pcre:"/\x2ehhp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.hlp; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_WinHelp; classtype:misc-activity; sid:5740; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks Realplayer .rmp playlist file download request"; flow:to_server,established; content:".rmp"; fast_pattern; nocase; http_uri; pcre:"/\x2ermp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2420; rev:16;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Fax Cover page document file download request"; flow:to_server,established; content:".cov"; fast_pattern; nocase; http_uri; pcre:"/\x2ecov([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cov; flowbits:noalert; classtype:misc-activity; sid:19218; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY XUL file download request"; flow:to_server,established; content:".xul"; fast_pattern; http_uri; pcre:"/\x2exul([\?\x5c\x2f]|$)/Umsi"; flowbits:set,file.xul; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.xul; classtype:misc-activity; sid:17600; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY FON font file download request"; flow:to_server,established; content:".fon"; fast_pattern; nocase; http_uri; pcre:"/\x2efon([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.fon; metadata:policy security-ips drop; reference:cve,2011-2003; reference:url,en.wikipedia.org/wiki/.fon; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-077; classtype:misc-activity; sid:20269; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK00PK|03 04|"; within:8; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20464; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY LNK file download request"; flow:to_server,established; content:".lnk"; fast_pattern; nocase; http_uri; pcre:"/\x2elnk([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.lnk; flowbits:noalert; classtype:misc-activity; sid:17441; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY PLF playlist file download request"; flow:to_server,established; content:".plf"; fast_pattern; nocase; http_uri; pcre:"/\x2eplf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.plf; flowbits:noalert; classtype:misc-activity; sid:16691; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY JPEG file magic detection"; flow:to_client,established; file_data; content:"|FF D8 FF|"; within:3; fast_pattern; flowbits:set,file.jpeg; flowbits:noalert; classtype:misc-activity; sid:20480; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Client Agent Helper JAR file download request"; flow:to_server,established; content:"_helper.jar"; fast_pattern:only; nocase; pcre:"/agent_(win|lin|mac)_helper.jar$/siU"; flowbits:set,file.jar.agent_helper; flowbits:noalert; reference:cve,2011-1969; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:misc-activity; sid:20260; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Audio Interchange file download request"; flow:to_server,established; content:".aif"; fast_pattern; nocase; http_uri; pcre:"/\x2eaif[cf]?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.aiff; flowbits:noalert; classtype:misc-activity; sid:15900; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY OpenType Font file download request"; flow:to_server,established; content:".otf"; fast_pattern; nocase; http_uri; pcre:"/\x2eotf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.otf; flowbits:noalert; classtype:misc-activity; sid:17751; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY amf file download request"; flow:to_server,established; content:".amf"; nocase; http_uri; pcre:"/\x2Eamf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.amf; flowbits:noalert; classtype:misc-activity; sid:20563; rev:3;)
# alert tcp $EXTERNAL_NET 554 -> $HOME_NET any (msg:"FILE-IDENTIFY Windows Media Player playlist download"; flow:to_client,established; content:"WMS_CONTENT_DESCRIPTION_PLAYLIST_ENTRY_START_OFFSET"; fast_pattern:only; flowbits:set,file.wmp_playlist; flowbits:noalert; classtype:misc-activity; sid:14264; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY XML file download request"; flow:to_server,established; content:".xml"; fast_pattern; nocase; http_uri; pcre:"/\x2exml([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xml; flowbits:noalert; classtype:misc-activity; sid:17733; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY AVI multimedia file download request"; flow:to_server,established; content:".avi"; fast_pattern; nocase; http_uri; pcre:"/\x2eavi([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.avi; flowbits:set,file.avi.video; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.avi; classtype:misc-activity; sid:15516; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Metastock mwl file magic detection"; flow:to_client,established; file_data; content:"[MetaStock"; within:10; fast_pattern; reference:url,www.equis.com/products/endofday/metastock/?overview; classtype:misc-activity; sid:20172; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY mx4 file magic detection"; flow:to_client,established; file_data; content:"|4D 58 43 33|"; within:4; fast_pattern; flowbits:set,file.wav; flowbits:noalert; classtype:misc-activity; sid:20512; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Word file download request"; flow:to_server,established; content:".doc"; fast_pattern; nocase; http_uri; pcre:"/\x2edoc([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.doc; flowbits:set,file.rtf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_word; classtype:misc-activity; sid:15587; rev:12;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office PowerPoint .MSProducerBF file download request"; flow:to_server,established; content:".MSProducerBF"; fast_pattern; nocase; http_uri; pcre:"/\x2eMSProducerBF([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.msproducer; flowbits:noalert; classtype:misc-activity; sid:16478; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY QuickDraw/PICT file download request"; flow:to_server,established; content:".pct"; nocase; http_uri; pcre:"/\x2epct([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.pct; flowbits:noalert; classtype:misc-activity; sid:18234; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY TrueType font file download request"; flow:to_server,established; content:".ttf"; fast_pattern; nocase; http_uri; pcre:"/\x2ettf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.ttf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/TrueType; classtype:misc-activity; sid:16286; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Audio wmf file download request"; flow:to_server,established; content:".wmf"; fast_pattern; nocase; http_uri; pcre:"/\x2ewmf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.wmf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.wmf; classtype:misc-activity; sid:2436; rev:18;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY PNG file download request"; flow:to_server,established; content:".png"; fast_pattern; nocase; http_uri; pcre:"/\x2epng([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.png; flowbits:noalert; classtype:misc-activity; sid:17380; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RSS file download request"; flow:to_server,established; content:".rss"; fast_pattern; nocase; http_uri; pcre:"/\x2erss([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rss; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Rss; classtype:misc-activity; sid:15945; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MOV file download request"; flow:to_server,established; content:".mov"; fast_pattern; nocase; http_uri; pcre:"/\x2emov([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.mov; classtype:misc-activity; sid:17259; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MKA file download request"; flow:to_server,established; content:".mka"; fast_pattern; nocase; http_uri; pcre:"/\x2emka([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mkv; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Matroska; classtype:misc-activity; sid:19424; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MHTML file download request"; flow:to_server,established; content:".mht"; fast_pattern; nocase; http_uri; pcre:"/\x2emht(ml)?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mht; flowbits:noalert; reference:url,en.wikipedia.org/wiki/MHTML; classtype:misc-activity; sid:19289; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY S3M file download request"; flow:to_server,established; content:".s3m"; fast_pattern; nocase; http_uri; pcre:"/\x2es3m([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.s3m; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.s3m; classtype:misc-activity; sid:20282; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY PLS multimedia playlist file download request"; flow:to_server,established; content:".pls"; fast_pattern; nocase; http_uri; pcre:"/\x2epls([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.pls; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.pls; classtype:misc-activity; sid:14018; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Universal Binary/Java Bytecode file magic detection"; flow:to_client,established; file_data; content:"|CA FE BA BE|"; within:4; fast_pattern; flowbits:set,file.universalbinary; flowbits:noalert; classtype:misc-activity; sid:20492; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe .pfb file download request"; flow:to_server, established; content:".pfb"; fast_pattern; nocase; http_uri; pcre:"/\x2epfb([\?\x5c\x2f]|$)/smiU"; reference:cve,2008-1806; reference:cve,2008-1807; reference:url,en.wikipedia.org/wiki/Printer_Font_Binary#Printer_Font_Binary; classtype:misc-activity; sid:16552; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detection"; flow:to_client,established; file_data; content:"XFIR"; within:4; fast_pattern; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20507; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Java .class file download request"; flow:to_server,established; content:".class"; fast_pattern; nocase; http_uri; pcre:"/\x2eclass([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.class; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Java_class_file; classtype:misc-activity; sid:15237; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY CSV file download request"; flow:to_server,established; content:".csv"; fast_pattern; nocase; http_uri; pcre:"/\x2ecsv([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.csv; flowbits:noalert; reference:cve,2008-0112; reference:url,en.wikipedia.org/wiki/Comma-separated_values; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-014; classtype:misc-activity; sid:13584; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|06 07|"; within:4; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20468; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft search file download request"; flow:to_server,established; content:".search-ms"; fast_pattern; nocase; http_uri; pcre:"/\x2esearch\x2dms([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.search-ms; flowbits:noalert; classtype:misc-activity; sid:13911; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".jpeg"; fast_pattern; nocase; http_uri; pcre:"/\x2ejpeg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16407; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detection"; flow:to_client,established; file_data; content:"FWS"; depth:3; byte_test:1,<,20,0,relative; isdataat:5,relative; content:!"|00 00 00 00|"; within:4; distance:1; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20496; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Apple Mach-O executable file magic detection"; flow:to_client,established; file_data; content:"|CA FE BA BE|"; within:4; byte_test:4, <, 20, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html; classtype:misc-activity; sid:18983; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Crystal Reports file magic detection"; flow:to_client,established; flowbits:isset,file.rpt; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1 00|"; within:9; fast_pattern; reference:bugtraq,21261; reference:cve,2006-6133; reference:url,en.wikipedia.org/wiki/Crystal_Report; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-052; classtype:misc-activity; sid:12456; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Windows CAB file magic detection"; flow:to_client,established; file_data; content:"MSCF"; within:4; fast_pattern; flowbits:set,file.cab; flowbits:noalert; classtype:misc-activity; sid:20461; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Flac file magic detection"; flow:to_client,established; file_data; content:"fLaC"; within:4; fast_pattern; flowbits:set,file.flac; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.flac; classtype:misc-activity; sid:20521; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY BAT file download request"; flow:to_server,established; content:".bat"; fast_pattern; nocase; http_uri; pcre:"/\x2ebat([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.bat; flowbits:noalert; classtype:misc-activity; sid:18273; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Script encoder file magic detection"; flow:to_client,established; file_data; content:"|23 40 7E 5E|"; within:4; fast_pattern; flowbits:set,file.screnc; flowbits:noalert; classtype:misc-activity; sid:20453; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MP3 file download request"; flow:to_server,established; content:".mp3"; fast_pattern; nocase; http_uri; pcre:"/\x2emp3([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mp3; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp3; classtype:misc-activity; sid:15922; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY caff file magic detection"; flow:to_client,established; file_data; content:"|63 61 66 66|"; within:4; fast_pattern; flowbits:set,file.caff; flowbits:noalert; classtype:misc-activity; sid:20516; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows .NET Application file download request"; flow:to_server,established; content:".application"; fast_pattern; nocase; http_uri; pcre:"/\x2eapplication([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.application; flowbits:noalert; reference:bugtraq,21688; reference:cve,2006-6696; reference:url,en.wikipedia.org/wiki/ASP.NET; classtype:misc-activity; sid:17508; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RIFF file magic detection"; flow:to_client,established; file_data; content:"RIFF"; within:4; fast_pattern; flowbits:set,file.avi; flowbits:set,file.wav; flowbits:noalert; classtype:misc-activity; sid:20470; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY SIS file magic detection"; flow:to_client,established; file_data; content:"|19 04 00 10|"; within:4; fast_pattern; flowbits:set,file.sis; flowbits:noalert; classtype:misc-activity; sid:20484; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Cisco Webex wrf file download request"; flow:to_server,established; content:".wrf"; fast_pattern; nocase; http_uri; pcre:"/\x2ewrf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.wrf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Webex; classtype:misc-activity; sid:19224; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Access MSISAM file magic detection"; flow:to_client,established; file_data; content:"MSISAM Database"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26468; reference:cve,2005-0944; reference:cve,2007-6026; reference:cve,2008-1092; reference:url,en.wikipedia.org/wiki/Microsoft_access; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-028; reference:url,www.microsoft.com/technet/security/advisory/950627.mspx; classtype:misc-activity; sid:13633; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY GIF file magic detection"; flow:to_client,established; file_data; content:"GIF8"; within:4; fast_pattern; content:"a"; within:1; distance:1; flowbits:set,file.gif; flowbits:noalert; classtype:misc-activity; sid:20459; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Ultimate Packer for Executables/UPX v0.51-v0.61 packed file magic detection"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"`|E8 00 00 00 00|X|83 E8|=P|8D B8|"; content:"|FF|W"; within:2; distance:3; content:"|8A 06|F|88 07|G|EB EB 90 90 90 B8 01 00 00 00 01|"; within:17; distance:28; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16434; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Visio file download request"; flow:to_server,established; content:".vsd"; fast_pattern; nocase; http_uri; pcre:"/\x2evsd([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.visio; flowbits:noalert; classtype:misc-activity; sid:15294; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Director Movie file download request"; flow:to_server,established; content:".dcr"; fast_pattern; nocase; http_uri; pcre:"/\x2edcr([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dir; flowbits:noalert; reference:url,www.fileinfo.com/extension/dcr; classtype:misc-activity; sid:17802; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Portable Executable binary file magic detection"; flow:to_client,established; file_data; content:"MZ|90 00|"; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; flowbits:set,file.exe; metadata:policy balanced-ips alert, policy security-ips drop, service http; classtype:misc-activity; sid:15306; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY vmd file magic detection"; flow:to_client,established; file_data; content:"|2E 03 00 00 01|"; within:5; fast_pattern; flowbits:set,file.vmd; flowbits:noalert; classtype:misc-activity; sid:20520; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MachO Little Endian file magic detection"; flow:to_client,established; file_data; content:"|CE FA ED FE|"; within:4; fast_pattern; flowbits:set,file.machole; flowbits:noalert; classtype:misc-activity; sid:20488; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Crystal Reports file download request"; flow:to_server,established; content:".rpt"; fast_pattern; nocase; http_uri; pcre:"/\x2erpt([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rpt; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Crystal_Report; classtype:misc-activity; sid:12455; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Flash Player FLV file magic detection"; flow:to_client,established; file_data; content:"FLV|01|"; content:"|00 00 00 09|"; within:4; distance:1; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.flv; classtype:misc-activity; sid:12182; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY XBM image file download request"; flow:to_server,established; content:".xbm"; fast_pattern; nocase; http_uri; pcre:"/\x2exbm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xbm; flowbits:noalert; reference:url,en.wikipedia.org/wiki/XBM; classtype:misc-activity; sid:17359; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft SYmbolic LinK file download request"; flow:to_server,established; content:".slk"; fast_pattern; nocase; http_uri; pcre:"/\x2eslk([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.slk; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2008-0112; reference:url,en.wikipedia.org/wiki/SYmbolic_LinK_(SYLK); reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-014; classtype:misc-activity; sid:13583; rev:14;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".pjpeg"; fast_pattern; nocase; http_uri; pcre:"/\x2epjpeg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:16529; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY BitTorrent torrent file download request"; flow:to_server,established; content:".torrent"; fast_pattern; nocase; http_uri; pcre:"/\x2etorrent([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.torrent; flowbits:noalert; classtype:misc-activity; sid:18593; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Excel xlw file magic detection"; flow:to_client,established; file_data; content:"|09 08 10 00 00 06 00 01|"; fast_pattern; flowbits:set,file.xlw; flowbits:noalert; reference:url,sc.openoffice.org/excelfileformat.pdf; classtype:misc-activity; sid:12283; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks RealMedia format file download request"; flow:to_server,established; content:".rv"; fast_pattern; nocase; http_uri; pcre:"/\x2erv([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realmedia; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Realmedia; classtype:misc-activity; sid:15240; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows help file download request"; flow:to_server,established; content:".hlp"; fast_pattern; nocase; http_uri; pcre:"/\x2ehlp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.hlp; reference:cve,2006-3357; reference:cve,2006-4138; classtype:misc-activity; sid:17407; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft asf file magic detection"; flow:to_client,established; file_data; content:"0&|B2|u"; within:4; fast_pattern; flowbits:set,file.asf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:16143; rev:11;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY XML Shareable Playlist Format file download request"; flow:to_server,established; content:".xspf"; fast_pattern; nocase; http_uri; pcre:"/\x2exspf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xspf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Xspf; classtype:misc-activity; sid:15158; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RealNetworks Real Media file magic detection"; flow:to_client,established; file_data; content:".RMF"; within:4; fast_pattern; flowbits:set,file.realplayer; flowbits:noalert; classtype:misc-activity; sid:20456; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows .NET Deploy file download request"; flow:to_server,established; flowbits:isset,file.manifest; content:".deploy"; fast_pattern; nocase; http_uri; pcre:"/\x2edeploy([\?\x5c\x2f]|$)/smiU"; reference:bugtraq,21688; reference:cve,2006-6696; reference:url,en.wikipedia.org/wiki/ASP.NET; classtype:misc-activity; sid:17510; rev:9;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"FILE-IDENTIFY Tiff little endian file magic detection"; flow:to_client,established; file_data; content:"II|2A 00|"; within:4; fast_pattern; flowbits:set,file.tiff.little; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Tagged_Image_File_Format; classtype:misc-activity; sid:17229; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY X PixMap file download request"; flow:to_server,established; content:".xpm"; fast_pattern; nocase; http_uri; pcre:"/\x2expm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xpm; flowbits:noalert; reference:url,en.wikipedia.org/wiki/X_PixMap; classtype:misc-activity; sid:16061; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY BAK file download request"; flow:to_server,established; content:".bak"; fast_pattern; nocase; http_uri; pcre:"/\x2ebak([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.bak; flowbits:noalert; classtype:misc-activity; sid:13915; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MKV file download request"; flow:to_server,established; content:".mkv"; fast_pattern; nocase; http_uri; pcre:"/\x2emkv([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mkv; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Matroska; classtype:misc-activity; sid:19423; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY bcproj file magic detection"; flow:to_client,established; file_data; content:"beat"; within:4; fast_pattern; flowbits:set,file.wav; flowbits:noalert; classtype:misc-activity; sid:20511; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY jarpack file magic detection"; flow:to_client,established; file_data; content:"|CA FE D0 0D|"; within:4; fast_pattern; flowbits:set,file.jarpack; flowbits:noalert; classtype:misc-activity; sid:20493; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ELF file magic detection"; flow:to_client,established; file_data; content:"|7F|ELF"; within:4; fast_pattern; flowbits:set,file.elf; flowbits:noalert; classtype:misc-activity; sid:20477; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"FILE-IDENTIFY .htr access file download request"; flow:to_server,established; content:".htr"; fast_pattern; nocase; http_uri; pcre:"/\x2ehtr([\?\x5c\x2f]|$)/smiU"; reference:bugtraq,1488; reference:cve,2000-0630; reference:cve,2001-0004; reference:nessus,10680; reference:url,technet.microsoft.com/en-us/security/bulletin/ms01-004; classtype:misc-activity; sid:987; rev:25;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY SIP log file magic detection"; flow:to_client,established; file_data; content:"|53 49 50 2D 48 49 54 20 28 53 49 50 2F 48|"; within:14; fast_pattern; flowbits:set,file.siplog; flowbits:noalert; classtype:misc-activity; sid:20485; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY GZip file magic detection"; flow:to_client,established; file_data; content:"|1F 8B 08 00|"; within:4; fast_pattern; flowbits:set,file.gzip; flowbits:noalert; classtype:misc-activity; sid:20452; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Director Movie file magic detection"; flow:to_client,established; file_data; content:"XFIR"; fast_pattern:only; flowbits:set,file.dir; flowbits:noalert; reference:url,www.fileinfo.com/extension/dir; classtype:misc-activity; sid:17801; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Ogg Stream file magic detection"; flow:to_client,established; file_data; content:"|4F 67 67 53|"; within:4; fast_pattern; flowbits:set,file.ogg; flowbits:noalert; classtype:misc-activity; sid:20462; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RealNetworks Realplayer REC file magic detection"; flow:to_client,established; file_data; content:".rec|00|"; within:5; fast_pattern; flowbits:set,file.realplayer; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:19128; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Portable Executable compact binary file magic detection"; flow:to_client,established; file_data; content:"MZ"; byte_jump:4,58,little,relative; content:"PE|00 00|"; within:4; distance:-64; content:"APECO"; distance:0; flowbits:set,file.pecompact; classtype:misc-activity; sid:13797; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows EMF metafile file download request"; flow:to_server,established; content:".emf"; fast_pattern; nocase; http_uri; pcre:"/\x2eemf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.emf; flowbits:noalert; classtype:misc-activity; sid:13678; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MP3 file magic detection"; flow:to_client,established; file_data; content:"|FF FB 90|"; within:3; fast_pattern; flowbits:set,file.mp3; flowbits:noalert; classtype:misc-activity; sid:20481; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Publisher file download request"; flow:to_server,established; content:".pub"; fast_pattern; nocase; http_uri; pcre:"/\x2epub([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.pub; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_publisher; classtype:misc-activity; sid:13473; rev:14;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Word file magic detection"; flow:to_client,established; file_data; content:"2|BE 00 00|"; within:4; fast_pattern; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20499; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Apple disk image file download request"; flow:to_server, established; content:".dmg"; fast_pattern; nocase; http_uri; pcre:"/\x2edmg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dmg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Apple_Disk_Image; classtype:misc-activity; sid:17679; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|01 02|"; within:4; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20465; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY BinHex file magic detection"; flow:to_client,established; file_data; content:"(This file must be converted with BinHex 4.0)"; fast_pattern:only; flowbits:set,file.binhex; flowbits:noalert; classtype:misc-activity; sid:20455; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY WAV file download request"; flow:to_server,established; content:".wav"; fast_pattern; nocase; http_uri; pcre:"/\x2ewav([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.wav; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Wav; classtype:misc-activity; sid:15079; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY QCP file download request"; flow:to_server,established; content:".qcp"; fast_pattern; nocase; http_uri; pcre:"/\x2eqcp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.qcp; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.qcp; classtype:misc-activity; sid:20287; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows PIF shortcut file download request"; flow:to_server,established; content:".pif"; fast_pattern; nocase; http_uri; pcre:"/\x2epif([\?\x5c\x2f]|$)/smiU"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2568; reference:url,en.wikipedia.org/wiki/Program_Information_File; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-046; reference:url,www.microsoft.com/technet/security/advisory/2286198.mspx; classtype:misc-activity; sid:17043; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Apple Quicktime qt file download request"; flow:to_server,established; content:".qt"; fast_pattern; nocase; http_uri; pcre:"/\x2eqt([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.mov; classtype:misc-activity; sid:17809; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY ARJ format file download request"; flow:to_server,established; content:".arj"; fast_pattern; nocase; http_uri; pcre:"/\x2earj([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.arj; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Arj; classtype:misc-activity; sid:15582; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY matroska file magic detection"; flow:to_client,established; file_data; content:"|1A 45 DF A3|"; content:"matroska"; within:50; nocase; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:19422; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Compound File Binary v4 file magic detection"; flow:to_client,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:">|00 04 00|"; within:4; distance:16; flowbits:set,file.oless.v4; flowbits:noalert; classtype:misc-activity; sid:16475; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Mail file download request"; flow:to_server,established; content:".eml"; fast_pattern; nocase; http_uri; pcre:"/\x2eeml([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.eml; flowbits:noalert; classtype:misc-activity; sid:18274; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"ftyp"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20501; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Fax Cover page document file download request"; flow:to_server,established; content:".cpe"; fast_pattern; nocase; http_uri; pcre:"/\x2ecpe([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cov; flowbits:noalert; classtype:misc-activity; sid:18675; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RAT file download request"; flow:to_server,established; content:".rat"; fast_pattern; nocase; http_uri; pcre:"/\x2erat([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rat; flowbits:noalert; classtype:misc-activity; sid:17426; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|05 06|"; within:4; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20466; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY PICT file magic detection"; flow:to_client,established; file_data; content:"PICT"; depth:4; fast_pattern; flowbits:set,file.pct; flowbits:noalert; classtype:misc-activity; sid:19907; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MIME file type file download request"; flow:to_server,established; content:".mim"; fast_pattern; nocase; http_uri; pcre:"/\x2emim([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mime; flowbits:noalert; classtype:misc-activity; sid:20032; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MP4 file download request"; flow:to_server,established; content:".mp4"; fast_pattern; nocase; http_uri; pcre:"/\x2emp4([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:15865; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file magic detection"; flow:to_client,established; file_data; content:"CWS"; within:3; fast_pattern; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20495; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Windows Address Book file magic detection"; flow:to_client,established; file_data; content:"|9C CB CB 8D 13|u|D2 11 91|X|00 C0|OyV|A4|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2006-2386; reference:url,en.wikipedia.org/wiki/Windows_Address_Book; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-076; classtype:misc-activity; sid:9639; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY PNG file magic detection"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; within:8; fast_pattern; flowbits:set,file.png; flowbits:noalert; classtype:misc-activity; sid:20478; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY bzip file magic detection"; flow:to_client,established; file_data; content:"BZh"; within:3; fast_pattern; flowbits:set,file.bzip; flowbits:noalert; classtype:misc-activity; sid:20458; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Windows Media ASF file magic detection"; flow:to_client,established; file_data; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; within:16; fast_pattern; flowbits:set,file.asf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Advanced_Systems_Format; classtype:misc-activity; sid:12454; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MPEG sys stream file magic detection"; flow:to_client,established; file_data; content:"|00 00 01 BA|"; within:4; fast_pattern; flowbits:set,file.mpeg; flowbits:noalert; classtype:misc-activity; sid:20451; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Movie Maker project file download request"; flow:to_server,established; content:".mswmm"; fast_pattern; nocase; http_uri; pcre:"/\x2emswmm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mswmm; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Windows_Movie_Maker; classtype:misc-activity; sid:16473; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RIFX file magic detection"; flow:to_client,established; file_data; content:"RIFX"; within:4; fast_pattern; flowbits:set,file.dir; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20471; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY HTA file download request"; flow:to_server,established; content:".hta"; fast_pattern; nocase; http_uri; pcre:"/\x2ehta([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.hta; flowbits:noalert; reference:url,en.wikipedia.org/wiki/HTML_Application; classtype:misc-activity; sid:3551; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|06 06|"; within:4; fast_pattern; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20469; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Excel file download request"; flow:to_server,established; content:".xlw"; fast_pattern; nocase; http_uri; pcre:"/\x2exlw([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.xls; flowbits:set,file.xlw; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.xls#File_formats; classtype:misc-activity; sid:15464; rev:13;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Word file download request"; flow:to_server,established; content:".wri"; fast_pattern; nocase; http_uri; pcre:"/\x2ewri([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:18516; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY ZIP archive file download request"; flow:to_server,established; content:".zip"; fast_pattern; nocase; http_uri; pcre:"/\x2ezip([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:19211; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MachO x64 Little Endian file magic detection"; flow:to_client,established; file_data; content:"|CF FA ED FE|"; within:4; fast_pattern; flowbits:set,file.macho64le; flowbits:noalert; classtype:misc-activity; sid:20489; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY dmg file magic detection"; flow:to_client,established; file_data; content:"|45 52 02 00|"; within:4; fast_pattern; flowbits:set,file.dmg; flowbits:noalert; classtype:misc-activity; sid:20514; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ivr file magic detection"; flow:to_client,established; file_data; content:".R1M"; within:4; fast_pattern; flowbits:set,file.ivr; flowbits:noalert; classtype:misc-activity; sid:20515; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY CDR file magic detection"; flow:to_client,established; file_data; content:"RIFF"; within:4; fast_pattern; content:"CDR"; within:3; distance:4; flowbits:set,file.cdr; reference:url,en.wikipedia.org/wiki/CorelDRAW#CDR_file_format; classtype:misc-activity; sid:20589; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY BMP file download request"; flow:to_server,established; content:".bmp"; fast_pattern; nocase; http_uri; pcre:"/\x2ebmp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.bmp; flowbits:noalert; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:16205; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Access JSDB file magic detection"; flow:to_client,established; file_data; content:"Jet System DB"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26468; reference:cve,2005-0944; reference:cve,2007-6026; reference:cve,2008-1092; reference:url,en.wikipedia.org/wiki/Microsoft_access; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-028; reference:url,www.microsoft.com/technet/security/advisory/950627.mspx; classtype:misc-activity; sid:13629; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks Realplayer .rp playlist file download request"; flow:to_server,established; content:".rp"; fast_pattern; nocase; http_uri; pcre:"/\x2erp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2423; rev:17;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RTF file download request"; flow:to_client,established; content:".rtf"; fast_pattern; nocase; http_uri; pcre:"/\x2ertf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rtf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Rich_Text_Format; classtype:misc-activity; sid:13801; rev:12;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MKS file download request"; flow:to_server,established; content:".mks"; fast_pattern; nocase; http_uri; pcre:"/\x2emks([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mkv; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Matroska; classtype:misc-activity; sid:19425; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY SMIL file download request"; flow:to_server,established; content:".smil"; fast_pattern; nocase; http_uri; pcre:"/\x2esmil([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.smil; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:17547; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MachO Big Endian file magic detection"; flow:to_client,established; file_data; content:"|FE ED FA CE|"; within:4; fast_pattern; flowbits:set,file.machobe; flowbits:noalert; classtype:misc-activity; sid:20490; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MPEG Layer 3 playlist file download request"; flow:to_server,established; content:".m3u"; fast_pattern; nocase; http_uri; pcre:"/\x2em3u([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.m3u; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.m3u; classtype:misc-activity; sid:14017; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks Realplayer .rt playlist file download request"; flow:to_server,established; content:".rt"; fast_pattern; nocase; http_uri; pcre:"/\x2ert([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.ram; classtype:misc-activity; sid:2422; rev:18;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY HyperText Markup Language file download request"; flow:to_server,established; content:".htm"; fast_pattern; nocase; http_uri; pcre:"/\x2ehtml?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.htm; flowbits:noalert; classtype:misc-activity; sid:18275; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Word file magic detection"; flow:to_client,established; file_data; content:"1|BE 00 00|"; within:4; fast_pattern; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20498; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Director Movie file download request"; flow:to_server,established; content:".dir"; fast_pattern; nocase; http_uri; pcre:"/\x2edir([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dir; flowbits:noalert; reference:url,www.fileinfo.com/extension/dir; classtype:misc-activity; sid:16219; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Media wmv file download request"; flow:to_server,established; content:".wmv"; fast_pattern; nocase; http_uri; pcre:"/\x2ewmv([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.wmv; flowbits:set,file.asf; flowbits:noalert; classtype:misc-activity; sid:17241; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RealNetworks Realplayer .r1m file magic detection"; flow:to_client,established; file_data; content:".r1m"; within:4; fast_pattern; flowbits:set,file.realplayer; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Realplayer; classtype:misc-activity; sid:19129; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY ZIP file magic detection"; flow:to_client,established; file_data; content:"PK|03 04|"; within:4; content:!"|14 00 06 00|"; within:4; flowbits:set,file.zip; flowbits:noalert; classtype:misc-activity; sid:20463; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Access TJDB file magic detection"; flow:to_client,established; file_data; content:"Temp Jet DB"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26468; reference:cve,2005-0944; reference:cve,2007-6026; reference:cve,2008-1092; reference:url,en.wikipedia.org/wiki/Microsoft_access; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-028; reference:url,www.microsoft.com/technet/security/advisory/950627.mspx; classtype:misc-activity; sid:13630; rev:10;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Works file download request"; flow:to_server,established; content:".wps"; fast_pattern; nocase; http_uri; pcre:"/\x2ewps([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.works; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_works; classtype:misc-activity; sid:13465; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY amf file magic detection"; flow:to_client,established; file_data; content:"AMF"; within:3; fast_pattern; flowbits:set,file.amf; flowbits:noalert; classtype:misc-activity; sid:20564; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Shockwave Flash file download request"; flow:to_server,established; content:".swf"; fast_pattern; nocase; http_uri; pcre:"/\x2eswf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.swf; classtype:misc-activity; sid:15483; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Symantec file magic detection"; flow:to_client,established; file_data; content:"|58 2D 53 79 6D 61 6E 74 65 63 2D|"; within:11; fast_pattern; flowbits:set,file.symantec; flowbits:noalert; classtype:misc-activity; sid:20474; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office PowerPoint file download request"; flow:to_server,established; content:".ppt"; fast_pattern; nocase; http_uri; pcre:"/\x2eppt([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.ppt; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_PowerPoint; classtype:misc-activity; sid:15586; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Word for Mac 5 file magic detection"; flow:to_client,established; file_data; content:"|FE|7|00 23|"; depth:4; fast_pattern; reference:bugtraq,25906; reference:cve,2007-3899; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-060; classtype:misc-activity; sid:12641; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY CDR file download request"; flow:to_server,established; content:".cdr"; fast_pattern:only; nocase; http_uri; pcre:"/\x2ecdr([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cdr; reference:url,en.wikipedia.org/wiki/CorelDRAW#CDR_file_format; classtype:misc-activity; sid:20588; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $FILE_DATA_PORTS (msg:"FILE-IDENTIFY rmf file download request"; flow:to_server,established; content:".rmf"; nocase; http_uri; pcre:"/\x2Ermf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rmf; flowbits:noalert; classtype:misc-activity; sid:20518; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MAKI file download request"; flow:to_server,established; content:".maki"; fast_pattern; nocase; http_uri; pcre:"/\x2emaki([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.maki; flowbits:noalert; classtype:misc-activity; sid:15426; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MIDI file download request"; flow:to_server,established; content:".mid"; fast_pattern; nocase; http_uri; pcre:"/\x2emid([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mid; flowbits:noalert; classtype:misc-activity; sid:19430; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY SMI file download request"; flow:to_server,established; content:".smi"; fast_pattern; nocase; http_uri; pcre:"/\x2esmi([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:set,file.dmg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/SAMI; classtype:misc-activity; sid:20223; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $FILE_DATA_PORTS (msg:"FILE-IDENTIFY vmd file download request"; flow:to_server,established; content:".vmd"; nocase; http_uri; pcre:"/\x2Evmd([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.vmd; flowbits:noalert; classtype:misc-activity; sid:20519; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office PowerPoint .MSProducer file download request"; flow:to_server,established; content:".MSProducer"; fast_pattern; nocase; http_uri; pcre:"/\x2eMSProducer([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.msproducer; flowbits:noalert; classtype:misc-activity; sid:16476; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY CHM file download request"; flow:to_server,established; content:".chm"; fast_pattern; nocase; http_uri; pcre:"/\x2echm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.chm; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_Compiled_HTML_Help; classtype:misc-activity; sid:3819; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Publisher file magic detection"; flow:to_client,established; file_data; content:"CHNKINK "; fast_pattern; flowbits:set,file.pub; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2006-0001; reference:url,en.wikipedia.org/wiki/Microsoft_publisher; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-054; classtype:misc-activity; sid:8478; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY RealNetworks RealMedia format file download request"; flow:to_server,established; content:".rm"; fast_pattern; nocase; http_uri; pcre:"/\x2erm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realmedia; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Realmedia; classtype:misc-activity; sid:15239; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY remote desktop configuration file download request"; flow:to_server,established; content:".rdp"; fast_pattern; nocase; http_uri; pcre:"/\x2erdp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.rdp; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Remote_Desktop_Protocol; classtype:misc-activity; sid:16742; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY PDF file magic detection"; flow:to_client,established; file_data; content:"%PDF-"; fast_pattern; nocase; flowbits:set,file.pdf; flowbits:noalert; classtype:misc-activity; sid:20494; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RTF file magic detection"; flow:to_client,established; file_data; content:"{|5C|rtf"; within:5; fast_pattern; flowbits:set,file.rtf; flowbits:noalert; classtype:misc-activity; sid:20486; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY 4XM file download request"; flow:to_server,established; content:".4xm"; fast_pattern; nocase; http_uri; pcre:"/\x2e4xm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.4xm; flowbits:noalert; reference:url,wiki.multimedia.cx/index.php?title=4xm_Format; classtype:misc-activity; sid:15870; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY M3U file magic detection"; flow:to_client,established; file_data; content:"|23|EXTM3U"; fast_pattern; flowbits:set,file.m3u; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.m3u; classtype:misc-activity; sid:9845; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"moov"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20500; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Flash Player FLV file download request"; flow:to_server,established; content:".flv"; fast_pattern; http_uri; pcre:"/\x2eflv([\?\x5c\x2f]|$)/Umsi"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.flv; classtype:misc-activity; sid:20544; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Windows Media download detection"; flow:to_client,established; content:"Content-Type|3A|"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a\s*(?=[av])(video\/x\-ms\-(w[vm]x|asf)|a(udio\/x\-ms\-w(m[av]|ax)|pplication\/x\-ms\-wm[zd]))/smiH"; classtype:misc-activity; sid:1437; rev:18;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Media Player .asf file magic detection"; flow:to_client,established; file_data; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; content:" |DB FE|L|F6|u|CF 11 9C 0F 00 A0 C9 03|I|CB|"; within:16; distance:8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-068; classtype:misc-activity; sid:12972; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Windows Media Player DVR file download request"; flow:to_server,established; content:".dvr-ms"; fast_pattern; nocase; http_uri; pcre:"/\x2edvr-ms([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dvr-ms; flowbits:noalert; classtype:misc-activity; sid:20733; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Office Word docx file download request"; flow:to_server,established; content:".docx"; fast_pattern; nocase; http_uri; pcre:"/\x2edocx([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.docx; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Microsoft_word; classtype:misc-activity; sid:20723; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY webm file download request"; flow:to_server,established; content:".webm"; fast_pattern; nocase; http_uri; pcre:"/\x2ewebm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.webm; flowbits:noalert; classtype:misc-activity; sid:20751; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY webm file magic detection"; flow:to_client,established; file_data; content:"|1A 45 DF A3|"; within:4; content:"webm"; within:4; distance:27; flowbits:set,file.webm; flowbits:noalert; classtype:misc-activity; sid:20750; rev:3;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eswf\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20798; rev:3;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Word file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edoc\x22/i"; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20795; rev:3;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MIME file type file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emim\x22/i"; flowbits:set,file.mime; flowbits:noalert; classtype:misc-activity; sid:20800; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MIME file type file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emim\x22/i"; flowbits:set,file.mime; flowbits:noalert; classtype:misc-activity; sid:20801; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office Excel file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2exls\x22/i"; flowbits:set,file.xls; flowbits:noalert; classtype:misc-activity; sid:20793; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eswf\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20799; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office Word file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edoc\x22/i"; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20796; rev:3;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Excel file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2exls\x22/i"; flowbits:set,file.xls; flowbits:noalert; classtype:misc-activity; sid:20792; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY X PixMap file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2expm\x22/i"; flowbits:set,file.xpm; flowbits:noalert; classtype:misc-activity; sid:20906; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY TwinVQ file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evqf\x22/i"; flowbits:set,file.vqf; flowbits:noalert; classtype:misc-activity; sid:20856; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MIDI file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emid\x22/i"; flowbits:set,file.mid; flowbits:noalert; classtype:misc-activity; sid:20899; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Autodesk Maya embedded language script download request"; flow:to_server,established; content:".ma"; fast_pattern; nocase; http_uri; pcre:"/\x2ema([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.autodesk_ma; flowbits:noalert; classtype:misc-activity; sid:20859; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY XML Shareable Playlist Format file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2exspf\x22/i"; flowbits:set,file.xspf; flowbits:noalert; classtype:misc-activity; sid:20914; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY DXF file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edxf\x22/i"; flowbits:set,file.dxf; flowbits:noalert; classtype:misc-activity; sid:20907; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY DAZ Studio script download request"; flow:to_server,established; content:".ds"; fast_pattern; nocase; http_uri; pcre:"/\x2eds[aeb]?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.daz_ds; flowbits:noalert; classtype:misc-activity; sid:20852; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY caff file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecaff\x22/i"; flowbits:set,file.caff; flowbits:noalert; classtype:misc-activity; sid:20915; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Windows Media ASF file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2easf\x22/i"; flowbits:set,file.asf; flowbits:noalert; classtype:misc-activity; sid:20910; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Video Spirit file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evisprj\x22/i"; flowbits:set,file.visprj; flowbits:noalert; classtype:misc-activity; sid:20894; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office Visio file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evsd\x22/i"; flowbits:set,file.visio; flowbits:noalert; classtype:misc-activity; sid:20855; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY EPS file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eeps\x22/i"; flowbits:set,file.eps; flowbits:noalert; classtype:misc-activity; sid:20911; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Video Spirit visprj download attempt"; flow:to_server,established; content:".visprj"; nocase; fast_pattern; http_uri; pcre:"/\x2evisprj([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.visprj; flowbits:noalert; classtype:misc-activity; sid:20888; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MAKI file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emaki\x22/i"; flowbits:set,file.maki; flowbits:noalert; classtype:misc-activity; sid:20849; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY AutoDesk 3D Studio Maxscript file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emax\x22/i"; flowbits:set,file.autodesk_max; flowbits:noalert; classtype:misc-activity; sid:20895; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY caff file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecaff\x22/i"; flowbits:set,file.caff; flowbits:noalert; classtype:misc-activity; sid:20916; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Windows Media ASF file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2easf\x22/i"; flowbits:set,file.asf; flowbits:noalert; classtype:misc-activity; sid:20909; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY eSignal .sum file download request"; flow:to_server,established; content:".sum"; fast_pattern; nocase; http_uri; pcre:"/\x2Esum([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.esignal; flowbits:noalert; reference:url,www.file-extensions.org/sum-file-extension; classtype:misc-activity; sid:20841; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY X PixMap file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2expm\x22/i"; flowbits:set,file.xpm; flowbits:noalert; classtype:misc-activity; sid:20905; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MIDI file magic detection"; flow:to_client,established; file_data; content:"MThd"; depth:4; flowbits:set,file.mid; flowbits:noalert; classtype:misc-activity; sid:20897; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Autodesk Maya file magic detected"; flow:to_client,established; file_data; content:"//Maya"; depth:6; fast_pattern; flowbits:set,file.autodesk_ma; flowbits:noalert; classtype:misc-activity; sid:20860; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY EPS file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eeps\x22/i"; flowbits:set,file.eps; flowbits:noalert; classtype:misc-activity; sid:20912; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Visio file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evsd\x22/i"; flowbits:set,file.visio; flowbits:noalert; classtype:misc-activity; sid:20854; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY TwinVQ file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evqf\x22/i"; flowbits:set,file.vqf; flowbits:noalert; classtype:misc-activity; sid:20857; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eemf\x22/i"; flowbits:set,file.emf; flowbits:noalert; classtype:misc-activity; sid:20851; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY DXF file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edxf\x22/i"; flowbits:set,file.dxf; flowbits:noalert; classtype:misc-activity; sid:20908; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MAKI file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emaki\x22/i"; flowbits:set,file.maki; flowbits:noalert; classtype:misc-activity; sid:20848; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY AutoDesk 3D Studio Maxscript file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emax\x22/i"; flowbits:set,file.autodesk_max; flowbits:noalert; classtype:misc-activity; sid:20896; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY BAK file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ebak\x22/i"; flowbits:set,file.bak; flowbits:noalert; classtype:misc-activity; sid:20917; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY eSignal .por file download request"; flow:to_server,established; content:".por"; fast_pattern; nocase; http_uri; pcre:"/\x2Epor([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.esignal; flowbits:noalert; reference:url,www.file-extensions.org/por-file-extension; classtype:misc-activity; sid:20840; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Autodesk 3D Studio Maxscript download request"; flow:to_server,established; content:".max"; fast_pattern; nocase; http_uri; pcre:"/\x2emax([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.autodesk_max; flowbits:noalert; classtype:misc-activity; sid:20869; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MIDI file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emid\x22/i"; flowbits:set,file.mid; flowbits:noalert; classtype:misc-activity; sid:20898; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY XML Shareable Playlist Format file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2exspf\x22/i"; flowbits:set,file.xspf; flowbits:noalert; classtype:misc-activity; sid:20913; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY eSignal .quo file download request"; flow:to_server,established; content:".quo"; fast_pattern; nocase; http_uri; pcre:"/\x2Equo([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.esignal; flowbits:noalert; reference:url,www.file-extensions.org/quo-file-extension; classtype:misc-activity; sid:20839; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eemf\x22/i"; flowbits:set,file.emf; flowbits:noalert; classtype:misc-activity; sid:20850; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY BAK file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ebak\x22/i"; flowbits:set,file.bak; flowbits:noalert; classtype:misc-activity; sid:20918; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Video Spirit file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2evisprj\x22/i"; flowbits:set,file.visprj; flowbits:noalert; classtype:misc-activity; sid:20893; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY OTF file download request"; flow:to_server,established; content:".otf"; fast_pattern; nocase; http_uri; pcre:"/\x2eotf([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.ttf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/TrueType; classtype:misc-activity; sid:20962; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office PowerPoint file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eppt\x22/i"; flowbits:set,file.ppt; flowbits:noalert; classtype:misc-activity; sid:20983; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY K3G file download request"; flow:to_server,established; content:".k3g"; fast_pattern; nocase; http_uri; pcre:"/\x2ek3g([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20976; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"mfra"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20951; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY PLS file magic detection"; flow:to_client,established; file_data; content:"[playlist]"; within:11; fast_pattern; flowbits:set,file.pls; flowbits:noalert; classtype:misc-activity; sid:20924; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Shockwave Flash file download request"; flow:to_server,established; content:".f4a"; fast_pattern; nocase; http_uri; pcre:"/\x2ef4a([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.swf; classtype:misc-activity; sid:20939; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"pnot"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20955; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"moof"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20950; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Shockwave Flash file download request"; flow:to_server,established; content:".f4b"; fast_pattern; nocase; http_uri; pcre:"/\x2ef4b([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.swf; classtype:misc-activity; sid:20940; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".jfi"; fast_pattern; nocase; http_uri; pcre:"/\x2ejfif?([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20967; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY QCP file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eqcp\x22/i"; flowbits:set,file.qcp; flowbits:noalert; classtype:misc-activity; sid:20935; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MKV file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emkv\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20929; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY DIB file download request"; flow:to_server,established; content:".dib"; fast_pattern; nocase; http_uri; pcre:"/\x2edib([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.bmp; flowbits:noalert; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:20963; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MKS file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emks\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20932; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4p\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20943; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY 3G2 file download request"; flow:to_server,established; content:".3g2"; fast_pattern; nocase; http_uri; pcre:"/\x2e3g2([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20975; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"skip"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20952; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".jif"; fast_pattern; nocase; http_uri; pcre:"/\x2ejif([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20966; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY M4B file download request"; flow:to_server,established; content:".m4b"; fast_pattern; nocase; http_uri; pcre:"/\x2em4b([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20973; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4v\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20941; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office PowerPoint file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eppt\x22/i"; flowbits:set,file.ppt; flowbits:noalert; classtype:misc-activity; sid:20982; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY TTE file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ette\x22/i"; flowbits:set,file.ttf; flowbits:noalert; classtype:misc-activity; sid:20979; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY M4V file download request"; flow:to_server,established; content:".m4v"; fast_pattern; nocase; http_uri; pcre:"/\x2em4v([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20972; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MKA file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emka\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20933; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"pict"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20956; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Shockwave Flash file download request"; flow:to_server,established; content:".f4p"; fast_pattern; nocase; http_uri; pcre:"/\x2ef4p([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.swf; classtype:misc-activity; sid:20938; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Pagemaker file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2epmd\x22/i"; flowbits:set,file.pmd; flowbits:noalert; classtype:misc-activity; sid:20925; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4p\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20944; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Word docx file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edocx\x22/i"; flowbits:set,file.docx; flowbits:noalert; classtype:misc-activity; sid:20986; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4b\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20947; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MKV file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emkv\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20930; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY JPEG file download request"; flow:to_server,established; content:".jpe"; fast_pattern; nocase; http_uri; pcre:"/\x2ejpe([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.jpeg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Jpg; classtype:misc-activity; sid:20965; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4a\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20945; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"junk"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20953; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY OTF file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eotf\x22/i"; flowbits:set,file.ttf; flowbits:noalert; classtype:misc-activity; sid:20981; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY TTE file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ette\x22/i"; flowbits:set,file.ttf; flowbits:noalert; classtype:misc-activity; sid:20978; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MKA file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emka\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20934; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Adobe Shockwave Flash file download request"; flow:to_server,established; content:".f4v"; fast_pattern; nocase; http_uri; pcre:"/\x2ef4v([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.swf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.swf; classtype:misc-activity; sid:20937; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Flac file download request"; flow:to_server,established; content:".flac"; fast_pattern; nocase; http_uri; pcre:"/\x2eflac([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.flac; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.flac; classtype:misc-activity; sid:20960; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY OTF file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eotf\x22/i"; flowbits:set,file.ttf; flowbits:noalert; classtype:misc-activity; sid:20980; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office Word file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ewri\x22/i"; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20985; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"meta"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20957; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY M4R file download request"; flow:to_server,established; content:".m4r"; fast_pattern; nocase; http_uri; pcre:"/\x2em4r([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20971; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Pagemaker file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2epmd\x22/i"; flowbits:set,file.pmd; flowbits:noalert; classtype:misc-activity; sid:20926; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"uuid"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20959; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4a\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20946; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4b\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20948; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Apple disk image file download request"; flow:to_server, established; content:".img"; fast_pattern; nocase; http_uri; pcre:"/\x2eimg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dmg; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Apple_Disk_Image; classtype:misc-activity; sid:20968; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Office Word file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ewri\x22/i"; flowbits:set,file.doc; flowbits:noalert; classtype:misc-activity; sid:20984; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY SKM file download request"; flow:to_server,established; content:".skm"; fast_pattern; nocase; http_uri; pcre:"/\x2eskm([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20977; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"wide"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20954; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY TTE file download request"; flow:to_server,established; content:".tte"; fast_pattern; nocase; http_uri; pcre:"/\x2ette([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.ttf; flowbits:noalert; reference:url,en.wikipedia.org/wiki/TrueType; classtype:misc-activity; sid:20961; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY SAMI file download request"; flow:to_server,established; content:".sami"; fast_pattern; nocase; http_uri; pcre:"/\x2esami([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; reference:url,en.wikipedia.org/wiki/SAMI; classtype:misc-activity; sid:20964; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY QCP file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eqcp\x22/i"; flowbits:set,file.qcp; flowbits:noalert; classtype:misc-activity; sid:20936; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY M4P file download request"; flow:to_server,established; content:".m4p"; fast_pattern; nocase; http_uri; pcre:"/\x2em4p([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20970; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY M4A file download request"; flow:to_server,established; content:".m4a"; fast_pattern; nocase; http_uri; pcre:"/\x2em4a([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20969; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Adobe Shockwave Flash file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ef4v\x22/i"; flowbits:set,file.swf; flowbits:noalert; classtype:misc-activity; sid:20942; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY SMIL file magic detection"; flow:to_client,established; file_data; content:"<smil>"; within:6; flowbits:set,file.smil; flowbits:noalert; reference:url,en.wikipedia.org/wiki/.smil; classtype:misc-activity; sid:20928; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Office Word docx file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2edocx\x22/i"; flowbits:set,file.docx; flowbits:noalert; classtype:misc-activity; sid:20987; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY 3GP file download request"; flow:to_server,established; content:".3gp"; fast_pattern; nocase; http_uri; pcre:"/\x2e3gp([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.quicktime; flowbits:noalert; reference:url,en.wikipedia.org/wiki/Mp4; classtype:misc-activity; sid:20974; rev:2;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MKS file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emks\x22/i"; flowbits:set,file.mkv; flowbits:noalert; classtype:misc-activity; sid:20931; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY MOV file magic detection"; flow:to_client,established; file_data; content:"meco"; depth:4; offset:4; fast_pattern; flowbits:set,file.quicktime; flowbits:noalert; classtype:misc-activity; sid:20958; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Visio file magic detected"; flow:established,to_client; file_data; content:"Visio |28|TM|29| Drawing|0D 0A|"; fast_pattern:only; flowbits:set,file.visio; reference:url,office.microsoft.com/en-us/visio/default.aspx; classtype:policy-violation; sid:11835; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY download of executable content"; flow:to_client,established; content:"application/octet-stream"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/octet-stream/smiH"; file_data; content:"MZ"; within:2; flowbits:set,file.exe; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:11192; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY download of executable content - x-header"; flow:to_client,established; content:"application/x-msdos-program"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/x-msdos-program/smiH"; file_data; content:"MZ"; within:2; flowbits:set,file.exe; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:16313; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY DAT file download request"; flow:established,to_server; content:".dat"; fast_pattern; nocase; http_uri; pcre:"/\x2edat([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.dat; classtype:misc-activity; sid:16630; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Media Player compressed skin download request"; flow:established,to_server; content:".wmd"; nocase; http_uri; pcre:"/\x2ewmd([\?\x5c\x2f]|$)/smiU"; reference:bugtraq,25305; reference:cve,2007-3037; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-047; classtype:policy-violation; sid:17546; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY TTF file magic detected"; flow:to_client,established; file_data; content:"|00 01 00 00|"; content:"cmap"; distance:0; flowbits:set,file.ttf; flowbits:noalert; classtype:misc-activity; sid:20991; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Cytel Studio cy3 file download request"; flow:to_server,established; content:".cy3"; fast_pattern; nocase; http_uri; pcre:"/\x2ecy3([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cy3; flowbits:noalert; classtype:misc-activity; sid:21012; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY Microsoft Money file download request"; flow:to_server,established; content:".mny"; fast_pattern; nocase; http_uri; pcre:"/\x2emny([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mny; flowbits:noalert; classtype:misc-activity; sid:21008; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Money file magic detected"; flow:to_client,established; file_data; content:"|00 01 00 00 4D 53 49 53|"; flowbits:isset,file.mny; flowbits:noalert; classtype:misc-activity; sid:21007; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY PDF file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2epdf\x22/i"; flowbits:set,file.pdf; flowbits:noalert; classtype:misc-activity; sid:21035; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY PDF file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2epdf\x22/i"; flowbits:set,file.pdf; flowbits:noalert; classtype:misc-activity; sid:21036; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY cy3 Cytel Studio file magic detection"; flow:to_client,established; file_data; content:"90"; depth:2; fast_pattern; content:"|0A|"; within:2; pcre:"/90\x0D?\x0A[^\x20]*\x20[^\x0A]*\x0A/i"; flowbits:set,file.cy3; flowbits:noalert; classtype:misc-activity; sid:21015; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Cytel Studio cyb file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecyb\x22/i"; flowbits:set,file.cyb; flowbits:noalert; classtype:misc-activity; sid:21016; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY SAMI file magic detected"; flow:to_client,established; file_data; content:"|3C|SAMI"; flowbits:set,file.smi; flowbits:noalert; classtype:misc-activity; sid:20992; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Cytel Studio cy3 file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecy3\x22/i"; flowbits:set,file.cy3; flowbits:noalert; classtype:misc-activity; sid:21014; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY cyb Cytel Studio file download request"; flow:to_server,established; content:".cyb"; fast_pattern; nocase; http_uri; pcre:"/\x2ecyb([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cyb; flowbits:noalert; classtype:misc-activity; sid:21018; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Powerpoint file magic detected"; flow:to_client,established; file_data; content:"P|00|o|00|w|00|e|00|r|00|P|00|o|00|i|00|n|00|t|00 20 00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t"; flowbits:isset,file.ppt; flowbits:noalert; classtype:misc-activity; sid:21011; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Cytel Studio cy3 file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecy3\x22/i"; flowbits:set,file.cy3; flowbits:noalert; classtype:misc-activity; sid:21013; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY cyb Cytel Studio file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecyb\x22/i"; flowbits:set,file.cyb; flowbits:noalert; classtype:misc-activity; sid:21017; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Microsoft Money file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emny\x22/i"; flowbits:set,file.mny; flowbits:noalert; classtype:misc-activity; sid:21010; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Microsoft Money file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2emny\x22/i"; flowbits:set,file.mny; flowbits:noalert; classtype:misc-activity; sid:21009; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY UltraISO CUE file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecue\x22/i"; flowbits:set,file.cue; flowbits:noalert; classtype:misc-activity; sid:21053; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY UltraISO CUE file download request"; flow:to_server,established; content:".cue"; fast_pattern; nocase; http_uri; pcre:"/\x2ecue([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.cue; flowbits:noalert; classtype:misc-activity; sid:21052; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY AVI file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eavi\x22/i"; flowbits:set,file.avi; flowbits:noalert; classtype:misc-activity; sid:21062; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY RIFF Video file magic detection"; flow:to_client,established; file_data; content:"RIFF"; depth:4; content:"AVI LIST"; within:8; distance:4; flowbits:set,file.avi.video; flowbits:noalert; classtype:misc-activity; sid:21059; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY UltraISO CUE file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ecue\x22/i"; flowbits:set,file.cue; flowbits:noalert; classtype:misc-activity; sid:21054; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY AVI file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2eavi\x22/i"; flowbits:set,file.avi; flowbits:noalert; classtype:misc-activity; sid:21061; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY s3m file download attempt"; flow:to_server,established; content:"|2E|s3m"; nocase; http_uri; pcre:"/\x2Es3m([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.s3m; flowbits:noalert; classtype:misc-activity; sid:21106; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY MPEG video stream file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2empeg\x22/i"; flowbits:set,file.mpeg; flowbits:noalert; classtype:misc-activity; sid:21110; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY Cisco Webex Player file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ewrf\x22/i"; flowbits:set,file.wrf; flowbits:noalert; classtype:misc-activity; sid:21115; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IDENTIFY Cisco Webex Player .wrf file magic detection"; flow:to_client,established; file_data; content:"|57 4F 54 46|"; fast_pattern:only; flowbits:set,file.wrf; flowbits:noalert; classtype:misc-activity; sid:21113; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-IDENTIFY MPEG video stream file attachment detected"; flow:to_server,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2empeg\x22/i"; flowbits:set,file.mpeg; flowbits:noalert; classtype:misc-activity; sid:21111; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IDENTIFY MPEG video stream file download request"; flow:to_server,established; content:".mpeg"; fast_pattern; nocase; http_uri; pcre:"/\x2empeg([\?\x5c\x2f]|$)/smiU"; flowbits:set,file.mpeg; flowbits:noalert; classtype:misc-activity; sid:21109; rev:1;)
# alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any (msg:"FILE-IDENTIFY Cisco Webex Player file attachment detected"; flow:to_client,established; content:"Content-Disposition: attachment|3B|"; fast_pattern:only; content:"filename=|22|"; nocase; pcre:"/filename=\x22[^\x22]*\x2ewrf\x22/i"; flowbits:set,file.wrf; flowbits:noalert; classtype:misc-activity; sid:21114; rev:1;)
