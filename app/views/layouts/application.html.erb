<!DOCTYPE html>
<html>
<head>
  <title>osProtect</title>
  <%= stylesheet_link_tag "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>

<body class="index osprotect_dashboard logged_in">
<div id="wrapper">
  <div id="header">
    <h1 id="site_title">osProtect</h1>
    <ul class="tabbed_navigation" id="tabs">
      <%#= main_menu %>
      <%
      menu_tabs.each do |page|
        highlight_current = ""
        if page == params[:controller].downcase
          highlight_current = "current"
        elsif page == 'pulse' && params[:controller].downcase == 'dashboard'
          highlight_current = "current"
        end
        if page == 'resque_server' %>
          <li id="<%="#{page}"%>" class="<%="#{highlight_current}"%>">
            <%= link_to 'Background jobs', resque_server_path, target: "_blank" %>
          </li>
        <%
        elsif page == 'pdfs' %>
        <li id="<%="#{page}"%>" class="<%="#{highlight_current}"%>">
            <%= link_to 'PDFs', pdfs_path %>
          </li>
        <%
        else %>
        <li id="<%="#{page}"%>" class="<%="#{highlight_current}"%>">
            <%= link_to page.camelcase, send("#{page}_path") %>
          </li>
        <%
        end
      end %>
    </ul>
    <p id="utility_nav">
      <span class="current_user">
        <%= current_user.role?(:admin) ? "admin user: " : "user: " %><%=current_user.username%>
      </span>
      <%= link_to 'Profile', edit_user_path(current_user), 'data-method'=>"get" %>
      <%= link_to 'Logout', logout_path, 'data-method'=>"get" %>
    </p>
  </div>

  <%= yield %>

  <div id="footer">
    <p>
      2012
      <% if APP_CONFIG[:show_versions_and_limits] %>
          &nbsp;&nbsp;<%= APP_CONFIG[:host] %>
          &nbsp;
          version: <%= APP_CONFIG[:version] %>
          &nbsp;&nbsp; Ruby: <%=RUBY_VERSION%>
          &nbsp;|&nbsp; Rails: <%=Rails::VERSION::STRING%>
          <% if APP_CONFIG[:max_events_per_pdf] %>
              &nbsp;|&nbsp; <%= number_with_delimiter(APP_CONFIG[:max_events_per_pdf]) %> records max per PDF
          <% end %>
          <% if APP_CONFIG[:per_page] %>
              &nbsp;|&nbsp; <%= number_with_delimiter(APP_CONFIG[:per_page]) %> items per page
          <% end %>
          &nbsp;&nbsp;
      <% end %>
      &nbsp;&nbsp;<%= Time.now.utc.strftime("%a %b %d, %Y %I:%M:%S %P %Z") %>
    </p>
  </div>
</div> <!-- wrapper -->
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"></div>
</body>
</html>
